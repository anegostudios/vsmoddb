"use strict";var R={get:e=>document.getElementById(e),make:function(e,...t){const[n,...a]=e.split("."),i=document.createElement(n);return a&&i.classList.add(...a),t&&i.append(...t),i},formatByteSize:function(e){return e>1073741824?(e/1073741824).toFixed(2)+" GB":e>1048576?(e/1048576).toFixed(2)+" MB":e>1024?(e/1024).toFixed(2)+" KB":e+" B"},onDOMLoaded:function(e){"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)},msgContainer:null,addMessage:function(e,t,n){n=n||!0;const a=R.make("div."+e);n?(a.textContent=t,a.append(R.make("span.dismiss"))):a.innerHTML=t+'<span class="dismiss"></span>',R.msgContainer.append(a)},markAsErrorElement:function(e){e.classList.add("invalid"),setTimeout(()=>e.classList.remove("invalid"),500)},attachDefaultFailHandler:function(e,t="Request failed"){return e.fail(e=>{let n;try{n=JSON.parse(e.responseText)}catch{R.addMessage(MSG_CLASS_ERROR,"Failed to parse response.",!1),n={reason:e.responseText}}R.addMessage(MSG_CLASS_ERROR,t+(n.reason?": "+n.reason:"."),!0)})}};R.msgContainer=R.get("message-container"),R.msgContainer.addEventListener("click",e=>{let t=e.target;t&&t.classList.contains("dismiss")&&(t=t.parentElement,$(t).slideUp(400,()=>t.remove()))});const MSG_CLASS_OK="bg-success.text-success",MSG_CLASS_WARN="bg-warning",MSG_CLASS_ERROR="bg-error.text-error";function attachUserSearchHandler(e){let t=null,n=null;const a=e.getElementsByClassName("chosen-search-input")[0],i=e.getElementsByTagName("select")[0],o=i.dataset.url;o?a.addEventListener("keydown",()=>{null!==t&&clearTimeout(t),n=t,t=setTimeout(()=>{const e=a.value;if(!e)return void(t=null);const r=n,s=o.replace("{name}",e);$.get(s,o=>{if(n!==r)return;if(!o)return void(t=null);const s=$(i).val();i.replaceChildren(...Array.from(i.querySelectorAll("option:checked")));for(const[e,t]of Object.entries(o)){if(null!=s&&s.includes(e))continue;const n=document.createElement("option");n.value=e,n.textContent=t,i.append(n)}const d=getComputedStyle(a).width;$(i).trigger("chosen:updated"),a.value=e,a.style.width=d,t=null})},500)}):console.warn("attachUserSearchHandler called on an element who's select does not have a url in its dataset.")}function attachDialogSendHandler(e,t,n){const a=e.getElementsByTagName("form");if(a.length<1)return void console.warn("Dialog is missing a form",e);const i=a[0];let o;for(const t of e.getElementsByTagName("button"))if("dialog"!==t.formMethod){o=t;break}o?o.addEventListener("click",()=>{const e=new FormData(i,o);if(!t(i,e))return;o.disabled=!0;const a=$.ajax(i.action,{method:i.dataset.method,processData:!1,contentType:!1,data:e});a.fail(()=>o.disabled=!1),n(a)}):console.warn("Dialog is missing a non closing (formmethod!=dialog) button",e)}!function(e){e.fn.areYouSure=function(t){var n=e.extend({message:"You have unsaved changes!",dirtyClass:"dirty",change:null,silent:!1,addRemoveFieldsMarksDirty:!1,fieldEvents:"change keyup propertychange input",fieldSelector:":input:not(input[type=submit]):not(input[type=button])"},t),a=function(t){if(t.hasClass("ays-ignore")||t.hasClass("aysIgnore")||t.attr("data-ays-ignore")||void 0===t.attr("name"))return null;if(t.is(":disabled"))return"ays-disabled";var n,a=t.attr("type");switch(t.is("select")&&(a="select"),a){case"checkbox":case"radio":n=t.is(":checked");break;case"select":n="",t.find("option").each(function(){var t=e(this);t.is(":selected")&&(n+=t.val())});break;default:n=t.val()}return n},i=function(e){e.data("ays-orig",a(e))},o=function(t){var i=function(e){var t=e.data("ays-orig");return void 0!==t&&a(e)!=t},o=e(this).is("form")?e(this):e(this).parents("form");if(i(e(t.target)))s(o,!0);else{var r=o.find(n.fieldSelector);if(n.addRemoveFieldsMarksDirty&&o.data("ays-orig-field-count")!=r.length)return void s(o,!0);var d=!1;r.each(function(){var t=e(this);if(i(t))return d=!0,!1}),s(o,d)}},r=function(t){var a=t.find(n.fieldSelector);e(a).each(function(){i(e(this))}),e(a).unbind(n.fieldEvents,o),e(a).bind(n.fieldEvents,o),t.data("ays-orig-field-count",e(a).length),s(t,!1)},s=function(e,t){var a=t!=e.hasClass(n.dirtyClass);e.toggleClass(n.dirtyClass,t),a&&(n.change&&n.change.call(e,e),t&&e.trigger("dirty.areYouSure",[e]),t||e.trigger("clean.areYouSure",[e]),e.trigger("change.areYouSure",[e]))},d=function(){var t=e(this),a=t.find(n.fieldSelector);e(a).each(function(){var t=e(this);t.data("ays-orig")||(i(t),t.bind(n.fieldEvents,o))}),t.trigger("checkform.areYouSure")},l=function(){r(e(this))};return n.silent||window.aysUnloadSet||(window.aysUnloadSet=!0,e(window).bind("beforeunload",function(){if(0!=e("form").filter("."+n.dirtyClass).length){if(navigator.userAgent.toLowerCase().match(/msie|chrome/)){if(window.aysHasPrompted)return;window.aysHasPrompted=!0,window.setTimeout(function(){window.aysHasPrompted=!1},900)}return n.message}})),this.each(function(){if(e(this).is("form")){var t=e(this);t.submit(function(){t.removeClass(n.dirtyClass)}),t.bind("reset",function(){s(t,!1)}),t.bind("rescan.areYouSure",d),t.bind("reinitialize.areYouSure",l),t.bind("checkform.areYouSure",o),r(t)}})}}(jQuery),R.onDOMLoaded(function(){$("select").each(function(){if(0==$(this).parents(".template").length){var e="noSearch"==$(this).attr("noSearch");$(this).chosen({placeholder_text_multiple:" ",disable_search:e})}}),$("form[name=form1]").areYouSure();for(const e of document.querySelectorAll("[data-opens-dialog]"))e.addEventListener("click",e=>{const t=e.currentTarget.dataset.opensDialog;let n;t&&(n=R.get(t))?n.showModal():console.warn("Failed to find dialog to open",t)})}),$(function(){navigator.userAgent.toLowerCase().match(/iphone|ipad|ipod|opera/)&&$("a").bind("click",function(e){var t=$(e.target).closest("a").attr("href");if(void 0!==t&&!t.match(/^#/)&&""!=t.trim()){var n=$(window).triggerHandler("beforeunload",n);return n&&""!=n&&!confirm(n+"\n\nPress OK to leave this page or Cancel to stay.")||(window.location.href=t),!1}})});
//# sourceMappingURL=script.js.map